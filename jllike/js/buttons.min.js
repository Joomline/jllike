var socialButtonCountObjects={},jllikeproShareUrls={mail:{},pinteres:{},linkedin:{}};jQuery.noConflict(),function($,w,d,undefined){function getParam(key){if(key){var pairs=top.location.search.replace(/^\?/,"").split("&");for(var i in pairs){var current,match=pairs[i].match(/([^=]*)=(\w*)/);if(match[1]===key)return decodeURIComponent(match[2])}}return!1}var ButtonConfiguration=function(params){return params?$.extend(!0,ButtonConfiguration.defaults,params):ButtonConfiguration.defaults};ButtonConfiguration.defaults={selectors:{facebookButton:".l-fb",twitterButton:".l-tw",vkontakteButton:".l-vk",odnoklassnikiButton:".l-ok",mailButton:".l-ml",linButton:".l-ln",pinteresButton:".l-pinteres",LivejournalButton:".l-lj",BloggerButton:".l-bl",WeiboButton:".l-wb",TelegramButton:".l-tl",WhatsappButton:".l-wa",ViberButton:".l-vi",count:".l-count",ico:".l-ico",shareTitle:"h2:eq(0)",shareSumary:"p:eq(0)",shareImages:"img[src]"},buttonDepth:2,alternativeImage:"",alternativeSummary:"",alternativeTitle:"",forceAlternativeImage:!1,forceAlternativeSummary:!1,forceAlternativeTitle:!1,classes:{countVisibleClass:"like-not-empty"},keys:{shareLinkParam:"href"},popupWindowOptions:["left=0","top=0","width=500","height=400","personalbar=0","toolbar=0","scrollbars=1","resizable=1"]};var Button=function(){};Button.lastIndex=0,Button.prototype={init:function($context,conf,index){this.config=conf,this.index=index,this.id=$($context).attr("id"),this.$context=$context,this.$count=$(this.config.selectors.count,this.$context),this.$ico=$(this.config.selectors.ico,this.$context),this.collectShareInfo(),this.bindEvents(),this.ajaxRequest=this.countLikes()},bindEvents:function(){this.$context.bind("click",Button.returnFalse),this.$ico.parent().bind("click",this,this.openShareWindow)},setCountValue:function(count){this.$context.addClass(this.config.classes.countVisibleClass),this.$count.text(count)},getCountLink:function(url){return this.countServiceUrl+encodeURIComponent(url)},collectShareInfo:function(){var $parent=this.$context,button=this;$parent=jQuery(jllickeproSettings.parentContayner).length>0?$parent.parents(jllickeproSettings.parentContayner).parent():$parent.parents(".jllikeproSharesContayner").parent();var $tmpParent,href=$("input.link-to-share",$parent).val(),title=$("input.share-title",$parent).val(),image=$("input.share-image",$parent).val(),origin=jllickeproSettings.url,$title=$(this.config.selectors.shareTitle,$parent),$summary;if($title.length||($title=$(this.config.selectors.shareTitle,$tmpParent)),($summary=$("input.share-desc",$parent).val()).length||($summary=$(this.config.selectors.shareSumary,$parent).text()),$summary.length||($summary=$parent.text()),$summary.length||($summary=$parent.parent().text()),this.domenhref=w.location.protocol+"//"+w.location.host,this.linkhref=jllickeproSettings.url+w.location.pathname+w.location.search,this.linkToShare=href||this.linkhref,this.title=""!=title?title:$title.text(),this.config.forceAlternativeTitle?this.title=this.config.alternativeTitle:""==this.title&&this.config.alternativeTitle?this.title=this.config.alternativeTitle:""==this.title&&(this.title=d.title),$summary.length>0?this.summary=$summary:this.summary=this.config.alternativeSummary?this.config.alternativeSummary:"",this.summary=this.summary.length>200?cropText(this.summary,200)+"...":this.summary,this.images=[],void 0!==image&&image.length)this.images[0]=image;else{var $images=$(this.config.selectors.shareImages,$parent);if($tmpParent=$parent,!$images.length)for(var $i=0;0==$images.length&&$i<20;)$i++,$tmpParent=$tmpParent.parent(),$images=$(this.config.selectors.shareImages,$tmpParent).not("#waitimg");$images.length>0&!this.config.forceAlternativeImage?($images.each((function(index,element){button.images[index]=element.src})),this.images=button.images):this.images[0]=this.config.alternativeImage?this.config.alternativeImage:void 0}},getPopupOptions:function(){return this.config.popupWindowOptions.join(",")},plusOne:function(){var parent=$("#"+this.id),counter=$("span.l-count",parent),count=counter.text();count=""==count?0:parseInt(count),parent.addClass("like-not-empty"),counter.text(count+1)},disableMoreLikes:function(){if(jllickeproSettings.disableMoreLikes){var parent=$("#"+this.id).parents(".jllikeproSharesContayner"),id=parent.children(".share-id").val(),date=new Date((new Date).getTime()+2592e6);document.cookie="jllikepro_article_"+id+"=1; path=/; expires="+date.toUTCString();var div=$("<div/>").addClass("disable_more_likes");parent.prepend(div)}},openShareWindow:function(e){var button=e.data,shareUri=button.getShareLink(),windowOptions=button.getPopupOptions(),newWindow=w.open(shareUri,"",windowOptions);button.plusOne(),button.disableMoreLikes(),w.focus&&newWindow.focus()},linkToShare:null,title:d.title,summary:null,images:[],countServiceUrl:null,$context:null,$count:null,$ico:null},Button=$.extend(Button,{returnFalse:function(e){return!1}});var cropText=function(text,length){var result="";return text.split(" ").every((function(item){var tmp=$.trim(item);return result.length+tmp.length<=length&&(""!=tmp&&(result+=" "+tmp),!0)})),result},FacebookButton=function($context,conf,index){this.init($context,conf,index),this.type="facebook"};FacebookButton.prototype=new Button,FacebookButton.prototype=$.extend(FacebookButton.prototype,{countLikes:function(){if(jllickeproSettings.enableCounters){var serviceURI=this.getCountLink(this.linkToShare),id=this.id;return $.ajax({url:serviceURI,dataType:"jsonp",success:function(data,status,jqXHR){if("success"==status&&void 0!==data.engagement&&void 0!==data.engagement.share_count&&data.engagement.share_count>0){var elem=$("#"+id);elem.addClass("like-not-empty"),$("span.l-count",elem).text(data.engagement.share_count),jllikeproAllCouner(elem)}}})}},getShareLink:function(){var url;return"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(this.linkToShare)+"&display=popup"},countServiceUrl:"https://graph.facebook.com/v4.0/?access_token=112243502800823|oj4WG8tofQaE5avNxB86XB4GkLE&fields=engagement&id="});var TwitterButton=function($context,conf,index){this.init($context,conf,index),this.type="twitter"};TwitterButton.prototype=new Button,TwitterButton.prototype=$.extend(TwitterButton.prototype,{countLikes:function(){},getShareLink:function(){var text=cropText(this.summary,140-this.title.length-this.linkToShare.length);return"https://twitter.com/intent/tweet?url="+encodeURIComponent(this.linkToShare)+"&text="+encodeURIComponent(this.title+". "+text)},countServiceUrl:"https://urls.api.twitter.com/1/urls/count.json?url="});var VkontakteButton=function($context,conf,index){this.init($context,conf,index),this.type="vkontakte"};VkontakteButton.prototype=new Button,VkontakteButton.prototype=$.extend(VkontakteButton.prototype,{countLikes:function(){if(jllickeproSettings.enableCounters){w.socialButtonCountObjects[this.index]=this;var serviceURI=this.getCountLink(this.linkToShare)+"&index="+this.index;if(void 0===w.VK&&(w.VK={}),void 0===w.VK.Share&&(w.VK.Share={}),void 0===w.VK.Share.count)w.VK.Share.count=function(index,count){vkShare(index,count)};else{var originalVkCount=w.VK.Share.count;w.VK.Share.count=function(index,count){vkShare(index,count),originalVkCount.call(w.VK.Share,index,count)}}return $.ajax({url:serviceURI,dataType:"jsonp"})}function vkShare(index,count){if(count>0){var id=w.socialButtonCountObjects[index].id,elem=$("#"+id);elem.addClass("like-not-empty"),$("span.l-count",elem).text(count),jllikeproAllCouner(elem)}}},getShareLink:function(){return"http://vk.com/share.php?url="+encodeURIComponent(this.linkToShare)},countServiceUrl:"https://vk.com/share.php?act=count&url="});var odnoklassnikiButton=function($context,conf,index){this.init($context,conf,index),this.type="odnoklassniki"};odnoklassnikiButton.prototype=new Button,odnoklassnikiButton.prototype=$.extend(odnoklassnikiButton.prototype,{countLikes:function(){if(jllickeproSettings.enableCounters){var serviceURI=this.getCountLink(this.id,this.linkToShare);if(w.ODKL){var originalOdCount=ODKL.updateCount;ODKL.updateCount=function(elementId,count){odklShare(elementId,count),originalOdCount(elementId,count)}}else w.ODKL={updateCount:function(elementId,count){odklShare(elementId,count)}};var id=this.id;return $.ajax({url:serviceURI,dataType:"jsonp"})}function odklShare(elementId,count){if(count>0){var elem=$("#"+elementId);elem.addClass("like-not-empty"),$("span.l-count",elem).text(count),jllikeproAllCouner(elem)}}},getShareLink:function(){return"https://connect.ok.ru/offer?url="+this.linkToShare+"&description="+encodeURIComponent(this.summary)},getCountLink:function(id,linkToShare){return this.countServiceUrl+id+"&ref="+encodeURIComponent(linkToShare)},countServiceUrl:"https://connect.ok.ru/dk?st.cmd=extLike&uid="});var mailButton=function($context,conf,index){this.init($context,conf,index),this.type="mailButton"};mailButton.prototype=new Button,mailButton.prototype=$.extend(mailButton.prototype,{countLikes:function(){if(jllickeproSettings.enableCounters){var id=this.id,serviceURI=this.getCountLink(this.linkToShare);return $.ajax({url:serviceURI,dataType:"jsonp",success:function(data,status,jqXHR){if("success"==status&&void 0!==data.share_mm&&data.share_mm>0){var elem=$("#"+id);elem.addClass("like-not-empty"),$("span.l-count",elem).text(data.share_mm),jllikeproAllCouner(elem)}}})}},getCountLink:function(linkToShare){return this.countServiceUrl+encodeURIComponent(linkToShare.replace("http://","").replace("https://",""))},getShareLink:function(){return url="https://connect.mail.ru/share?url="+encodeURIComponent(this.linkToShare)+"&image_url="+encodeURIComponent(this.images[0])+"&title="+encodeURIComponent(this.title)+"&description="+encodeURIComponent(this.summary)},countServiceUrl:"https://appsmail.ru/share/count/"});var linButton=function($context,conf,index){this.init($context,conf,index),this.type="linButton"};linButton.prototype=new Button,linButton.prototype=$.extend(linButton.prototype,{countLikes:function(){if(jllickeproSettings.enableCounters){jllikeproShareUrls.linkedin[this.linkToShare]=this.id,w.setLinkedInCount=function(data){if(jllikeproShareUrls.linkedin.hasOwnProperty(data.url)){var id=jllikeproShareUrls.linkedin[data.url],shares=data.count;if(shares>0){var elem=$("#"+id);elem.addClass("like-not-empty"),$("span.l-count",elem).text(shares),jllikeproAllCouner(elem)}}};var serviceURI=this.getCountLink(this.linkToShare);return $.ajax({url:serviceURI,dataType:"jsonp"})}},getShareLink:function(){return"http://www.linkedin.com/shareArticle?mini=true&ro=false&trk=bookmarklet&url="+this.linkToShare},countServiceUrl:"https://www.linkedin.com/countserv/count/share?&callback=setLinkedInCount&format=jsonp&url="});var pinteresButton=function($context,conf,index){this.init($context,conf,index),this.type="pinteresButton"};pinteresButton.prototype=new Button,pinteresButton.prototype=$.extend(pinteresButton.prototype,{countLikes:function(){if(jllickeproSettings.enableCounters)return jllikeproShareUrls.pinteres[this.linkToShare]=this.id,w.setPinteresCount=function(data){if(data.hasOwnProperty("count")){if(!jllikeproShareUrls.pinteres.hasOwnProperty(data.url))return;var id=jllikeproShareUrls.pinteres[data.url];if(data.count>0){var elem=$("#"+id);elem.addClass("like-not-empty"),$("span.l-count",elem).text(data.count),jllikeproAllCouner(elem)}}},serviceURI=this.getCountLink(this.linkToShare),$.ajax({url:serviceURI,dataType:"jsonp"})},getShareLink:function(){var media=null!=this.images[0]?this.images[0]:"";return"http://www.pinterest.com/pin/create/button/?url="+encodeURIComponent(this.linkToShare)+"&media="+media+"&description="+this.summary},countServiceUrl:"https://api.pinterest.com/v1/urls/count.json?callback=setPinteresCount&url="});var LivejournalButton=function($context,conf,index){this.init($context,conf,index),this.type="livejournal"};LivejournalButton.prototype=new Button,LivejournalButton.prototype=$.extend(LivejournalButton.prototype,{countLikes:function(){},getShareLink:function(){return"http://livejournal.com/update.bml?subject="+encodeURIComponent(this.title)+"&event="+encodeURIComponent('<a href="'+this.linkToShare+'">'+this.title+"</a> "+this.summary)},countServiceUrl:"http://livejournal.com/"});var BloggerButton=function($context,conf,index){this.init($context,conf,index),this.type="Blogger"};BloggerButton.prototype=new Button,BloggerButton.prototype=$.extend(BloggerButton.prototype,{countLikes:function(){},getShareLink:function(){return"https://www.blogger.com/blog-this.g?u="+encodeURIComponent(this.linkToShare)+"&n="+encodeURIComponent(this.title)},countServiceUrl:"https://www.blogger.com/"});var WeiboButton=function($context,conf,index){this.init($context,conf,index),this.type="Weibo"};WeiboButton.prototype=new Button,WeiboButton.prototype=$.extend(WeiboButton.prototype,{countLikes:function(){},getShareLink:function(){return"http://service.weibo.com/share/share.php?url="+encodeURIComponent(this.linkToShare)+"&title="+encodeURIComponent(this.title)},countServiceUrl:"http://service.weibo.com/"});var TelegramButton=function($context,conf,index){this.init($context,conf,index),this.type="Telegram"};TelegramButton.prototype=new Button,TelegramButton.prototype=$.extend(TelegramButton.prototype,{countLikes:function(){},getShareLink:function(){return"https://t.me/share/url?url=url="+encodeURIComponent(this.linkToShare)+"&text="+encodeURIComponent(this.title)},countServiceUrl:"https://t.me/"});var WhatsappButton=function($context,conf,index){this.init($context,conf,index),this.type="Whatsapp"};WhatsappButton.prototype=new Button,WhatsappButton.prototype=$.extend(WhatsappButton.prototype,{countLikes:function(){},getShareLink:function(){return"https://api.whatsapp.com/send?text="+encodeURIComponent(this.title)+" - "+encodeURIComponent(this.linkToShare)},countServiceUrl:"https://api.whatsapp.com"});var ViberButton=function($context,conf,index){this.init($context,conf,index),this.type="Viber"};ViberButton.prototype=new Button,ViberButton.prototype=$.extend(ViberButton.prototype,{countLikes:function(){},getShareLink:function(){return"viber://forward?text="+encodeURIComponent(this.linkToShare)},countServiceUrl:"https://viber.com"});var jllikeproAllCouner=function(element){var parent=$(element).parents(".jllikeproSharesContayner"),counterSpan=parent.find("span.l-all-count"),counterValue=0,tmpVal;parent.find(".l-count").not(".l-all-count").each((function(){""!=(tmpVal=$(this).text())&&(counterValue+=parseInt(tmpVal))})),counterSpan.text(counterValue)};$.fn.socialButton=function(config){return this.each((function(index,element){setTimeout((function(){var $element=$(element),conf=new ButtonConfiguration(config),b=!1;Button.lastIndex++,$element.is(conf.selectors.facebookButton)?b=new FacebookButton($element,conf,Button.lastIndex):$element.is(conf.selectors.twitterButton)?b=new TwitterButton($element,conf,Button.lastIndex):$element.is(conf.selectors.vkontakteButton)?b=new VkontakteButton($element,conf,Button.lastIndex):$element.is(conf.selectors.odnoklassnikiButton)?b=new odnoklassnikiButton($element,conf,Button.lastIndex):$element.is(conf.selectors.mailButton)?b=new mailButton($element,conf,Button.lastIndex):$element.is(conf.selectors.linButton)?b=new linButton($element,conf,Button.lastIndex):$element.is(conf.selectors.pinteresButton)?b=new pinteresButton($element,conf,Button.lastIndex):$element.is(conf.selectors.LivejournalButton)?b=new LivejournalButton($element,conf,Button.lastIndex):$element.is(conf.selectors.BloggerButton)?b=new BloggerButton($element,conf,Button.lastIndex):$element.is(conf.selectors.WeiboButton)?b=new WeiboButton($element,conf,Button.lastIndex):$element.is(conf.selectors.TelegramButton)?b=new TelegramButton($element,conf,Button.lastIndex):$element.is(conf.selectors.WhatsappButton)?b=new WhatsappButton($element,conf,Button.lastIndex):$element.is(conf.selectors.ViberButton)&&(b=new ViberButton($element,conf,Button.lastIndex)),$.when(b.ajaxRequest).then((function(){$element.trigger("socialButton.done",[b.type])}),(function(){$element.trigger("socialButton.done",[b.type])}))}),0)})),this},$.scrollToButton=function(hashParam,duration){if(!w.location.hash&&w.location.search){var currentHash=getParam(hashParam);if(currentHash){var $to=$("#"+currentHash);$to.length>0&&$("html,body").animate({scrollTop:$to.offset().top,scrollLeft:$to.offset().left},duration||1e3)}}return this}}(jQuery,window,document),jQuery(document).ready((function($){$(".like").socialButton();var likes=$("div.jllikeproSharesContayner"),contayner=jllickeproSettings.buttonsContayner;""!=contayner&&$(contayner).length>0&&likes.length>0&&0==jllickeproSettings.isCategory&&(likes.remove(),$(contayner).html(likes))}));